{"ast":null,"code":"var _jsxFileName = \"D:\\\\ps\\\\React forms\\\\new_up\\\\front\\\\src\\\\index.js\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport Master from \"./master.js\";\nimport Admin from \"react-crud-admin\";\nimport Form from \"react-jsonschema-form\";\nimport axios from \"axios\";\nimport Select from 'react-select';\nimport \"react-crud-admin/css\"; //optional css import\n\nconst _ = require(\"lodash\");\n\nfunction paginate(array, page_size, page_number) {\n  // human-readable page numbers usually start with 1, so we reduce 1 in the first argument\n  return array.slice((page_number - 1) * page_size, page_number * page_size);\n}\n\nexport default class Main extends Admin {\n  constructor() {\n    super();\n    this.name = \"Tenant\";\n    this.name_plural = \"Tenants\";\n    this.list_display_links = [\"master\"];\n    this.list_display = [\"master\", \"moduleName\", \"tenantId\"];\n    this.list_per_page = 10;\n    this.state = {\n      isLoggedIn: false\n    };\n    this.handleClick = this.handleClick.bind(this);\n  }\n\n  handleClick() {\n    this.setState(prevState => {\n      return {\n        isLoggedIn: !prevState.isLoggedIn\n      };\n    });\n  }\n\n  get_queryset(page_number, list_per_page, queryset) {\n    axios.get(\"/masters\", {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      /* let data = paginate(response.data, list_per_page, page_number)\n      this.set_queryset(data);\n      this.set_total(response.data.length);\n      this.pages_in_pagination = response.data.length / list_per_page;\n      console.log(\"You is amazee!\"); */\n      console.log(typeof response.data);\n      console.log(response.data);\n      this.set_queryset(response.data);\n    });\n    return queryset;\n  }\n\n  form_submit(form) {\n    let tenant = form.formData;\n\n    if (form.edit) {\n      console.log(\"This is a edit\", tenant);\n      this.state.queryset.splice(this.state.queryset.indexOf(this.state.object), 1, tenant); //var ind=this.state.queryset.indexOf(this.state.object);\n      //console.log(ind);\n\n      this.response_change(tenant);\n    } else {\n      this.response_add(tenant);\n    }\n  }\n\n  response_add(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/add\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n      this.set_queryset(response.data);\n      console.log(typeof response.data);\n      console.log(response.data);\n    });\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  response_change(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/update\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n      this.set_queryset(response.data);\n      console.log(typeof response.data);\n      console.log(response.data);\n    });\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  get_actions() {\n    return {\n      \"delete\": selected_objects => {\n        console.log(selected_objects);\n        axios.post(\"/masters/pb/tenant/tenants/delete\", {\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: selected_objects\n        }).then(response => {\n          this.set_queryset(response.data);\n          console.log(typeof response.data);\n          console.log(response.data);\n        }); //this.set_queryset(this.get_queryset());\n\n        this.setState({\n          queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n        });\n      }\n    };\n  }\n\n  render_list_view() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 7\n      }\n    }, this.render_add_button(), this.render_below_add_button(), this.render_search_field(), this.render_below_search_field(), this.render_actions(), this.render_below_actions(), this.render_filters(), this.render_below_filters(), this.render_table(), this.render_add_button(), this.render_below_table(), this.render_progress(this.state.loading), this.render_below_progress(), this.render_pagination());\n  }\n\n  action_selected(event) {\n    let action = event.target.value;\n    console.log(this.state.selected_objects.getItems());\n    this.get_actions()[action](this.state.selected_objects.getItems());\n    this.get_queryset(this.state.page_number, this.get_list_per_page());\n  }\n\n  render_actions() {\n    return /*#__PURE__*/React.createElement(\"select\", {\n      className: \"ra-action-button\",\n      onChange: this.action_selected.bind(this),\n      defaultValue: \"\",\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 197,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      key: \"key\",\n      selected: true,\n      value: \"\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 9\n      }\n    }, \"Choose an action\"), _.keys(this.get_actions()).map(action => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: action,\n        value: action,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 13\n        }\n      }, \" \", _.startCase(action));\n    }));\n  }\n\n  get_filters() {\n    return {\n      by_master_name: {\n        options: [{\n          value: \"FireCess\",\n          label: \"FireCess\"\n        }, {\n          value: \"boundary-data\",\n          label: \"boundary-data\"\n        }],\n        filter_function: (option, queryset) => {\n          let grouped = _.groupBy(queryset, \"master\");\n\n          return _.has(grouped, option.value) ? grouped[option.value] : [];\n        }\n      },\n      by_module_name: {\n        options: [{\n          value: \"PropertyTax\",\n          label: \"PropertyTax\"\n        }, {\n          value: \"egov-location\",\n          label: \"egov-location\"\n        }],\n        filter_function: (option, queryset) => {\n          let grouped = _.groupBy(queryset, \"moduleName\");\n\n          return _.has(grouped, option.value) ? grouped[option.value] : [];\n        }\n      }\n    };\n  }\n\n  _create_object_link(object, label) {\n    //this.setState({ viewMaster: false });\n    if (this.has_change_permission(object)) {\n      return (\n        /*#__PURE__*/\n        //<a href={object.tenantId.split('.').pop()+\"/\"+object.moduleName+\"/\"+object.master}>\n        React.createElement(\"a\", {\n          href: \"/masters/pb/tenant/tenants\",\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 7\n          }\n        }, \" \", label, \" \")\n      );\n    } else {\n      return /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 12\n        }\n      }, \" \", label, \" \");\n    }\n  }\n\n  _get_table_body() {\n    return this._get_ordered_queryset().map((object, i) => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: \"row-\" + i,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 11\n        }\n      }, \" \", /*#__PURE__*/React.createElement(\"input\", {\n        type: \"checkbox\",\n        id: i + \"_checkbox\",\n        onChange: this._select_one(object),\n        checked: this.state.selected_objects.contains(object),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 13\n        }\n      }), \" \", /*#__PURE__*/React.createElement(\"label\", {\n        htmlFor: i + \"_checkbox\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 13\n        }\n      }, \"\\xA0\"), \" \"), this.get_list_display().map(item => {\n        return /*#__PURE__*/React.createElement(\"td\", {\n          key: item,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 288,\n            columnNumber: 15\n          }\n        }, \" \", this.get_list_display_links().find(a => {\n          return item == a;\n        }) ? this._create_object_link(object, this._display_field(object, item)) : this._display_field(object, item), \" \");\n      }));\n    });\n  }\n\n  get_form(object = null) {\n    // TODO:\n    // read params tenantId, module, master\n    // load schema using API for tenantId, module and master\n    // use that schema for editing\n    if (!object) {\n      return /*#__PURE__*/React.createElement(Form, {\n        schema: this.schema,\n        onSubmit: this.form_submit.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 315,\n          columnNumber: 14\n        }\n      });\n    } else {\n      console.log(\"return form with data\", object);\n      return /*#__PURE__*/React.createElement(Form, {\n        schema: this.schema,\n        formData: object,\n        onSubmit: this.form_submit.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 318,\n          columnNumber: 14\n        }\n      });\n    }\n  }\n\n  componentDidMount() {\n    axios.get(\"/schema/module/masterName\", {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      console.log(typeof response.data);\n      console.log(response.data);\n      this.schema = response.data;\n    });\n  }\n\n}\nReactDOM.render( /*#__PURE__*/React.createElement(Main, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 340,\n    columnNumber: 17\n  }\n}), document.getElementById(\"root\")); //<Route exact path=\"/user/:userId\" component={UserPage} />","map":{"version":3,"sources":["D:/ps/React forms/new_up/front/src/index.js"],"names":["React","ReactDOM","Master","Admin","Form","axios","Select","_","require","paginate","array","page_size","page_number","slice","Main","constructor","name","name_plural","list_display_links","list_display","list_per_page","state","isLoggedIn","handleClick","bind","setState","prevState","get_queryset","queryset","get","headers","then","response","console","log","data","set_queryset","form_submit","form","tenant","formData","edit","splice","indexOf","object","response_change","response_add","d","post","body","get_actions","selected_objects","render_list_view","render_add_button","render_below_add_button","render_search_field","render_below_search_field","render_actions","render_below_actions","render_filters","render_below_filters","render_table","render_below_table","render_progress","loading","render_below_progress","render_pagination","action_selected","event","action","target","value","getItems","get_list_per_page","keys","map","startCase","get_filters","by_master_name","options","label","filter_function","option","grouped","groupBy","has","by_module_name","_create_object_link","has_change_permission","_get_table_body","_get_ordered_queryset","i","_select_one","contains","get_list_display","item","get_list_display_links","find","a","_display_field","get_form","schema","componentDidMount","render","document","getElementById"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport Master from \"./master.js\";\n\nimport Admin from \"react-crud-admin\";\nimport Form from \"react-jsonschema-form\";\nimport axios from \"axios\";\nimport Select from 'react-select';\n\nimport \"react-crud-admin/css\"; //optional css import\nconst _ = require(\"lodash\");\nfunction paginate(array, page_size, page_number) {\n  // human-readable page numbers usually start with 1, so we reduce 1 in the first argument\n  return array.slice((page_number - 1) * page_size, page_number * page_size);\n}\n\n\nexport default class Main extends Admin {\n  constructor() {\n    super();\n    this.name = \"Tenant\";\n    this.name_plural = \"Tenants\";\n    this.list_display_links = [\"master\"];\n    this.list_display = [\"master\",\"moduleName\",  \"tenantId\"];\n   \n    this.list_per_page = 10;\n    this.state = {\n        isLoggedIn: false\n    }\n    this.handleClick = this.handleClick.bind(this)\n    \n    \n  }\n\n  handleClick() {\n    this.setState(prevState => {\n        return {\n            isLoggedIn: !prevState.isLoggedIn\n        }\n    })\n}\n\n\n  get_queryset(page_number, list_per_page, queryset) {\n\n\n    axios.get(\"/masters\",{\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n      }\n    \n    }).then(response => {\n\n      /* let data = paginate(response.data, list_per_page, page_number)\n      this.set_queryset(data);\n      this.set_total(response.data.length);\n      this.pages_in_pagination = response.data.length / list_per_page;\n      console.log(\"You is amazee!\"); */\n      console.log(typeof(response.data));\n      console.log(response.data);\n      this.set_queryset(response.data);\n\n    });\n\n    return queryset;\n\n\n  }\n\n  form_submit(form) {\n    let tenant = form.formData;\n\n    if (form.edit) {\n      console.log(\"This is a edit\", tenant)\n      this.state.queryset.splice(this.state.queryset.indexOf(this.state.object), 1, tenant);\n\n      //var ind=this.state.queryset.indexOf(this.state.object);\n      //console.log(ind);\n      this.response_change(tenant);\n    }\n    else {\n\n      this.response_add(tenant);\n    }\n  }\n\n\n  response_add(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/add\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n\n\n      this.set_queryset(response.data);\n\n      console.log(typeof (response.data));\n      console.log(response.data);\n\n    });\n\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  response_change(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/update\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n\n\n      this.set_queryset(response.data);\n\n      console.log(typeof (response.data));\n      console.log(response.data);\n\n    });\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  get_actions() {\n    return {\n      \"delete\": (selected_objects) => {\n        console.log(selected_objects);\n\n        axios.post(\"/masters/pb/tenant/tenants/delete\", {\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: selected_objects\n        }).then(response => {\n\n\n          this.set_queryset(response.data);\n          console.log(typeof (response.data));\n          console.log(response.data);\n\n        })\n\n\n        //this.set_queryset(this.get_queryset());\n        this.setState({\n\n          queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n        });\n\n      }\n    }\n\n  }\n  render_list_view() {\n    return (\n      <div>\n        {this.render_add_button()}\n        {this.render_below_add_button()}\n        {this.render_search_field()}\n        {this.render_below_search_field()}\n        {this.render_actions()}\n        {this.render_below_actions()}\n        {this.render_filters()}\n        {this.render_below_filters()}\n        {this.render_table()}\n        {this.render_add_button()}\n        {this.render_below_table()}\n        {this.render_progress(this.state.loading)}\n        {this.render_below_progress()}\n        {this.render_pagination()}\n      </div>\n    );\n  }\n  action_selected(event) {\n    let action = event.target.value;\n \n    console.log(this.state.selected_objects.getItems());\n    this.get_actions()[action](this.state.selected_objects.getItems());\n    this.get_queryset(this.state.page_number, this.get_list_per_page());\n  }\n\n  \n  render_actions() {\n    \n    return (\n      <select\n        className=\"ra-action-button\"\n        onChange={this.action_selected.bind(this)}\n        defaultValue={\"\"}\n        value=\"\"\n         \n      >\n        <option key=\"key\" selected value=\"\" disabled={true}>\n          Choose an action\n        </option>\n        {_.keys(this.get_actions()).map(action => {\n          return (\n            <option key={action} value={action}>\n              {\" \"}\n              {_.startCase(action)}\n            </option>\n            \n          );\n        })}\n      \n      </select>\n    );\n    \n  }\n\n\n\n  get_filters()\n{\n  \n  \n  return {\n    \n    by_master_name: {\n       options: [\n        { value: \"FireCess\", label: \"FireCess\" },\n        { value: \"boundary-data\", label: \"boundary-data\" }\n      ], \n      filter_function: (option, queryset) => {\n        let grouped = _.groupBy(queryset, \"master\");\n\n        return _.has(grouped, option.value) ? grouped[option.value] : [];\n      }\n    },\n     by_module_name: {\n      options: [\n        { value: \"PropertyTax\", label: \"PropertyTax\" },\n        { value: \"egov-location\", label: \"egov-location\" }\n      ],\n      filter_function: (option, queryset) => {\n        let grouped = _.groupBy(queryset, \"moduleName\");\n\n        return _.has(grouped, option.value) ? grouped[option.value] : [];\n      }\n    } \n    \n  };\n}\n\n  \n\n\n_create_object_link(object, label) {\n  //this.setState({ viewMaster: false });\n  if (this.has_change_permission(object)) {\n    return (\n      //<a href={object.tenantId.split('.').pop()+\"/\"+object.moduleName+\"/\"+object.master}>\n      <a href=\"/masters/pb/tenant/tenants\">\n        {\" \"}\n        {label}{\" \"}\n      </a>\n    );\n  } else {\n    return <span> {label} </span>;}\n  }\n  _get_table_body() {\n    return this._get_ordered_queryset().map((object, i) => {\n      return (\n        <tr key={\"row-\" + i}>\n          <td>\n            {\" \"}\n            <input\n              type=\"checkbox\"\n              id={i + \"_checkbox\"}\n              onChange={this._select_one(object)}\n              checked={this.state.selected_objects.contains(object)}\n            />{\" \"}\n            <label htmlFor={i + \"_checkbox\"}>&nbsp;</label>{\" \"}\n          </td>\n          {this.get_list_display().map(item => {\n            return (\n              <td key={item}>\n                {\" \"}\n                {this.get_list_display_links().find(a => {\n                  return item == a;\n                })\n                  ? this._create_object_link(\n                      object,\n                      this._display_field(object, item)\n                    )\n                  : this._display_field(object, item)}{\" \"}\n              </td>\n            );\n          })}\n        </tr>\n      );\n    });\n  }\n\n  get_form(object = null) {\n\n    // TODO:\n    // read params tenantId, module, master\n    // load schema using API for tenantId, module and master\n    // use that schema for editing\n\n  \n    if (!object) {\n      return <Form schema={this.schema} onSubmit={this.form_submit.bind(this)} />;\n    } else {\n      console.log(\"return form with data\", object);\n      return <Form schema={this.schema} formData={object} onSubmit={this.form_submit.bind(this)} />;\n    } \n  }\n  componentDidMount(){\n    axios.get(\"/schema/module/masterName\",{\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json',\n      }\n    \n    }).then(response => {\n    \n      console.log(typeof(response.data));\n      console.log(response.data);\n      this.schema=response.data;\n      \n    });\n  }\n\n\n}\n\nReactDOM.render(<Main />, document.getElementById(\"root\"));\n\n\n//<Route exact path=\"/user/:userId\" component={UserPage} />"]},"metadata":{},"sourceType":"module"}