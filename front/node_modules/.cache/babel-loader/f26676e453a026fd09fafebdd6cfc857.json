{"ast":null,"code":"var _jsxFileName = \"D:\\\\ps\\\\React forms\\\\new_up\\\\front\\\\src\\\\ui.js\";\nimport React from \"react\";\nimport Admin from \"react-crud-admin\";\nimport Form from \"react-jsonschema-form\";\nimport axios from \"axios\";\nimport \"react-crud-admin/css\"; //optional css import\n\nconst _ = require(\"lodash\");\n\nfunction paginate(array, page_size, page_number) {\n  // human-readable page numbers usually start with 1, so we reduce 1 in the first argument\n  return array.slice((page_number - 1) * page_size, page_number * page_size);\n}\n\nexport default class Main extends Admin {\n  constructor() {\n    super();\n    this.name = \"Tenant\";\n    this.name_plural = \"Tenants\";\n    this.list_display_links = [\"master\"];\n    this.list_display = [\"master\", \"moduleName\", \"tenantId\"];\n    this.list_per_page = 10;\n  }\n\n  get_queryset(page_number, list_per_page, queryset) {\n    axios.get(\"/masters\", {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      /* let data = paginate(response.data, list_per_page, page_number)\r\n      this.set_queryset(data);\r\n      this.set_total(response.data.length);\r\n      this.pages_in_pagination = response.data.length / list_per_page;\r\n      console.log(\"You is amazee!\"); */\n      console.log(typeof response.data);\n      console.log(response.data);\n      this.set_queryset(response.data);\n    });\n    return queryset;\n  }\n\n  form_submit(form) {\n    let tenant = form.formData;\n\n    if (form.edit) {\n      console.log(\"This is a edit\", tenant);\n      this.state.queryset.splice(this.state.queryset.indexOf(this.state.object), 1, tenant); //var ind=this.state.queryset.indexOf(this.state.object);\n      //console.log(ind);\n\n      this.response_change(tenant);\n    } else {\n      this.response_add(tenant);\n    }\n  }\n\n  response_add(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/add\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n      this.set_queryset(response.data);\n      console.log(typeof response.data);\n      console.log(response.data);\n    });\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  response_change(d) {\n    console.log(d);\n    axios.post(\"/masters/pb/tenant/tenants/update\", {\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: d\n    }).then(response => {\n      this.set_queryset(response.data);\n      console.log(typeof response.data);\n      console.log(response.data);\n    });\n    this.setState({\n      object: null,\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n    });\n  }\n\n  get_actions() {\n    return {\n      \"delete\": selected_objects => {\n        console.log(selected_objects);\n        axios.post(\"/masters/pb/tenant/tenants/delete\", {\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: selected_objects\n        }).then(response => {\n          this.set_queryset(response.data);\n          console.log(typeof response.data);\n          console.log(response.data);\n        }); //this.set_queryset(this.get_queryset());\n\n        this.setState({\n          queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\n        });\n      }\n    };\n  }\n\n  render_list_view() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 7\n      }\n    }, this.render_add_button(), this.render_below_add_button(), this.render_search_field(), this.render_below_search_field(), this.render_actions(), this.render_below_actions(), this.render_filters(), this.render_below_filters(), this.render_table(), this.render_add_button(), this.render_below_table(), this.render_progress(this.state.loading), this.render_below_progress(), this.render_pagination());\n  }\n\n  action_selected(event) {\n    let action = event.target.value;\n    console.log(this.state.selected_objects.getItems());\n    this.get_actions()[action](this.state.selected_objects.getItems());\n    this.get_queryset(this.state.page_number, this.get_list_per_page());\n  }\n\n  render_actions() {\n    return /*#__PURE__*/React.createElement(\"select\", {\n      className: \"ra-action-button\",\n      onChange: this.action_selected.bind(this),\n      defaultValue: \"\",\n      value: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      key: \"key\",\n      selected: true,\n      value: \"\",\n      disabled: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 9\n      }\n    }, \"Choose an action\"), _.keys(this.get_actions()).map(action => {\n      return /*#__PURE__*/React.createElement(\"option\", {\n        key: action,\n        value: action,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 13\n        }\n      }, \" \", _.startCase(action));\n    }));\n  }\n\n  get_filters() {\n    return {\n      \"tenantId\": {\n        \"options\": [{\n          value: 'one',\n          label: 'Master'\n        }, {\n          value: 'two',\n          label: 'Module Name'\n        }],\n        \"filter_function\": (option, queryset) => {\n          return queryset;\n        }\n      }\n    };\n  }\n\n  _handle_filter_change(values) {\n    if (!(values instanceof Array) && values != null) {\n      values = [values];\n    }\n\n    this.setState({\n      filter_values: values || []\n    });\n\n    if (values == null || values.length <= 0) {\n      this.set_queryset(this.get_queryset(this.state.page_number, this.get_list_per_page(), this.state.queryset));\n      return;\n    }\n\n    let filters = this.get_filters();\n\n    for (let value of values) {\n      let queryset = filters[value._filter_].filter_function(value, this.state.queryset);\n\n      this.setState({\n        queryset: queryset\n      });\n    }\n  }\n\n  render_filters() {\n    let options = [];\n    let filters = this.get_filters();\n\n    for (let filter of _.keys(filters)) {\n      options.push({\n        label: _.startCase(filter),\n        value: filter,\n        disabled: true,\n        filter: null\n      });\n\n      if (filters[filter].options.length > 0) {\n        for (let option of filters[filter].options) {\n          option._filter_ = filter;\n          options.push(option);\n        }\n      }\n\n      if (this.state.filter_options[filter]) {\n        for (let option of this.state.filter_options[filter]) {\n          option._filter_ = filter;\n          options.push(option);\n        }\n      }\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        marginLeft: \"10px\",\n        width: \"100%\"\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Select, {\n      name: \"filter-form\",\n      multi: true,\n      onChange: this._handle_filter_change.bind(this),\n      closeOnSelect: true,\n      value: this.state.filter_values,\n      removeSelected: true,\n      placeholder: \"Select a filter\",\n      options: options,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 279,\n        columnNumber: 9\n      }\n    }));\n  }\n\n  sort_by(sort_fields) {\n    return this.state.queryset ? this.state.queryset : [];\n  }\n\n  _sort_handler(field) {\n    return event => {\n      let index = _.findIndex(this.sort_fields, item => item.hasOwnProperty(field));\n\n      if (index >= 0) {\n        if (this.sort_fields[index][field] == \"asc\") {\n          this.sort_fields[index][field] = \"desc\";\n        } else {\n          this.sort_fields = _.filter(this.sort_fields, item => !item.hasOwnProperty(field));\n        }\n      } else {\n        let temp = {};\n        temp[field] = \"asc\";\n        this.sort_fields.push(temp);\n      }\n\n      this.sort_by(this.sort_fields);\n      this.forceUpdate();\n    };\n  }\n\n  get_form(object = null) {\n    // TODO:\n    // read params tenantId, module, master\n    // load schema using API for tenantId, module and master\n    // use that schema for editing\n    axios.get(\"/schema/module/masterName\", {\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      }\n    }).then(response => {\n      console.log(typeof response.data);\n      console.log(response.data);\n      this.schema = response.data;\n    });\n\n    if (!object) {\n      return /*#__PURE__*/React.createElement(Form, {\n        schema: this.schema,\n        onSubmit: this.form_submit.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 14\n        }\n      });\n    } else {\n      console.log(\"return form with data\", object);\n      return /*#__PURE__*/React.createElement(Form, {\n        schema: this.schema,\n        formData: object,\n        onSubmit: this.form_submit.bind(this),\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 345,\n          columnNumber: 14\n        }\n      });\n    }\n  }\n\n}","map":{"version":3,"sources":["D:/ps/React forms/new_up/front/src/ui.js"],"names":["React","Admin","Form","axios","_","require","paginate","array","page_size","page_number","slice","Main","constructor","name","name_plural","list_display_links","list_display","list_per_page","get_queryset","queryset","get","headers","then","response","console","log","data","set_queryset","form_submit","form","tenant","formData","edit","state","splice","indexOf","object","response_change","response_add","d","post","body","setState","get_actions","selected_objects","render_list_view","render_add_button","render_below_add_button","render_search_field","render_below_search_field","render_actions","render_below_actions","render_filters","render_below_filters","render_table","render_below_table","render_progress","loading","render_below_progress","render_pagination","action_selected","event","action","target","value","getItems","get_list_per_page","bind","keys","map","startCase","get_filters","label","option","_handle_filter_change","values","Array","filter_values","length","filters","_filter_","filter_function","options","filter","push","disabled","filter_options","marginLeft","width","sort_by","sort_fields","_sort_handler","field","index","findIndex","item","hasOwnProperty","temp","forceUpdate","get_form","schema"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport Admin from \"react-crud-admin\";\r\nimport Form from \"react-jsonschema-form\";\r\nimport axios from \"axios\";\r\n\r\n\r\nimport \"react-crud-admin/css\"; //optional css import\r\nconst _ = require(\"lodash\");\r\nfunction paginate(array, page_size, page_number) {\r\n  // human-readable page numbers usually start with 1, so we reduce 1 in the first argument\r\n  return array.slice((page_number - 1) * page_size, page_number * page_size);\r\n}\r\n\r\n\r\nexport default class Main extends Admin {\r\n  constructor() {\r\n    super();\r\n    this.name = \"Tenant\";\r\n    this.name_plural = \"Tenants\";\r\n    this.list_display_links = [\"master\"];\r\n    this.list_display = [\"master\",\"moduleName\",  \"tenantId\"];\r\n   \r\n    this.list_per_page = 10;\r\n    \r\n  }\r\n\r\n\r\n  get_queryset(page_number, list_per_page, queryset) {\r\n\r\n\r\n    axios.get(\"/masters\",{\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json',\r\n      }\r\n    \r\n    }).then(response => {\r\n\r\n      /* let data = paginate(response.data, list_per_page, page_number)\r\n      this.set_queryset(data);\r\n      this.set_total(response.data.length);\r\n      this.pages_in_pagination = response.data.length / list_per_page;\r\n      console.log(\"You is amazee!\"); */\r\n      console.log(typeof(response.data));\r\n      console.log(response.data);\r\n      this.set_queryset(response.data);\r\n\r\n    });\r\n\r\n    return queryset;\r\n\r\n\r\n  }\r\n\r\n  form_submit(form) {\r\n    let tenant = form.formData;\r\n\r\n    if (form.edit) {\r\n      console.log(\"This is a edit\", tenant)\r\n      this.state.queryset.splice(this.state.queryset.indexOf(this.state.object), 1, tenant);\r\n\r\n      //var ind=this.state.queryset.indexOf(this.state.object);\r\n      //console.log(ind);\r\n      this.response_change(tenant);\r\n    }\r\n    else {\r\n\r\n      this.response_add(tenant);\r\n    }\r\n  }\r\n\r\n\r\n  response_add(d) {\r\n    console.log(d);\r\n    axios.post(\"/masters/pb/tenant/tenants/add\", {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: d\r\n    }).then(response => {\r\n\r\n\r\n      this.set_queryset(response.data);\r\n\r\n      console.log(typeof (response.data));\r\n      console.log(response.data);\r\n\r\n    });\r\n\r\n    this.setState({\r\n      object: null,\r\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\r\n    });\r\n  }\r\n\r\n  response_change(d) {\r\n    console.log(d);\r\n    axios.post(\"/masters/pb/tenant/tenants/update\", {\r\n      headers: {\r\n        'Content-Type': 'application/json'\r\n      },\r\n      body: d\r\n    }).then(response => {\r\n\r\n\r\n      this.set_queryset(response.data);\r\n\r\n      console.log(typeof (response.data));\r\n      console.log(response.data);\r\n\r\n    });\r\n    this.setState({\r\n      object: null,\r\n      queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\r\n    });\r\n  }\r\n\r\n  get_actions() {\r\n    return {\r\n      \"delete\": (selected_objects) => {\r\n        console.log(selected_objects);\r\n\r\n        axios.post(\"/masters/pb/tenant/tenants/delete\", {\r\n          headers: {\r\n            'Content-Type': 'application/json'\r\n          },\r\n          body: selected_objects\r\n        }).then(response => {\r\n\r\n\r\n          this.set_queryset(response.data);\r\n          console.log(typeof (response.data));\r\n          console.log(response.data);\r\n\r\n        })\r\n\r\n\r\n        //this.set_queryset(this.get_queryset());\r\n        this.setState({\r\n\r\n          queryset: this.get_queryset(this.state.page_number, this.list_per_page, this.state.queryset)\r\n        });\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n  render_list_view() {\r\n    return (\r\n      <div>\r\n        {this.render_add_button()}\r\n        {this.render_below_add_button()}\r\n        {this.render_search_field()}\r\n        {this.render_below_search_field()}\r\n        {this.render_actions()}\r\n        {this.render_below_actions()}\r\n        {this.render_filters()}\r\n        {this.render_below_filters()}\r\n        {this.render_table()}\r\n        {this.render_add_button()}\r\n        {this.render_below_table()}\r\n        {this.render_progress(this.state.loading)}\r\n        {this.render_below_progress()}\r\n        {this.render_pagination()}\r\n      </div>\r\n    );\r\n  }\r\n  action_selected(event) {\r\n    let action = event.target.value;\r\n \r\n    console.log(this.state.selected_objects.getItems());\r\n    this.get_actions()[action](this.state.selected_objects.getItems());\r\n    this.get_queryset(this.state.page_number, this.get_list_per_page());\r\n  }\r\n\r\n  \r\n  render_actions() {\r\n    \r\n    return (\r\n      <select\r\n        className=\"ra-action-button\"\r\n        onChange={this.action_selected.bind(this)}\r\n        defaultValue={\"\"}\r\n        value=\"\"\r\n         \r\n      >\r\n        <option key=\"key\" selected value=\"\" disabled={true}>\r\n          Choose an action\r\n        </option>\r\n        {_.keys(this.get_actions()).map(action => {\r\n          return (\r\n            <option key={action} value={action}>\r\n              {\" \"}\r\n              {_.startCase(action)}\r\n            </option>\r\n            \r\n          );\r\n        })}\r\n      \r\n      </select>\r\n    );\r\n  }\r\n\r\n  get_filters() {\r\n    \r\n\treturn {\r\n \r\n\t    \"tenantId\" : { \"options\" : [\r\n\t\t\t    { value: 'one', label: 'Master' },\r\n\t    { value: 'two', label: 'Module Name' },\r\n \r\n\t\t\r\n\t    ],\r\n\t     \"filter_function\" : (option,queryset)=>\r\n\t     {\r\n \r\n \r\n\t\t return queryset;\r\n\t     }\r\n           }\r\n\t    \r\n\t}\r\n  }\r\n\r\n  _handle_filter_change(values) {\r\n    if (!(values instanceof Array) && values != null) {\r\n      values = [values];\r\n    }\r\n \r\n    this.setState({ filter_values: values || [] });\r\n \r\n    if (values == null || values.length <= 0) {\r\n      this.set_queryset(\r\n        this.get_queryset(\r\n          this.state.page_number,\r\n          this.get_list_per_page(),\r\n          this.state.queryset\r\n        )\r\n      );\r\n      return;\r\n    }\r\n \r\n    let filters = this.get_filters();\r\n    for (let value of values) {\r\n      let queryset = filters[value._filter_].filter_function(\r\n        value,\r\n        this.state.queryset\r\n      );\r\n      this.setState({ queryset: queryset });\r\n    }\r\n  }\r\n  render_filters() {\r\n    let options = [];\r\n    let filters = this.get_filters();\r\n    for (let filter of _.keys(filters)) {\r\n      options.push({\r\n        label: _.startCase(filter),\r\n        value: filter,\r\n        disabled: true,\r\n        filter: null\r\n      });\r\n \r\n      if (filters[filter].options.length > 0) {\r\n        for (let option of filters[filter].options) {\r\n          option._filter_ = filter;\r\n          options.push(option);\r\n        }\r\n      }\r\n      if (this.state.filter_options[filter]) {\r\n        for (let option of this.state.filter_options[filter]) {\r\n          option._filter_ = filter;\r\n          options.push(option);\r\n        }\r\n      }\r\n    }\r\n \r\n    return (\r\n      <div style={{ marginLeft: \"10px\", width: \"100%\" }}>\r\n        <Select\r\n          name=\"filter-form\"\r\n          multi={true}\r\n          onChange={this._handle_filter_change.bind(this)}\r\n          closeOnSelect={true}\r\n          value={this.state.filter_values}\r\n          removeSelected={true}\r\n          placeholder={\"Select a filter\"}\r\n          options={options}\r\n        />\r\n      </div>\r\n    );\r\n  }\r\n  sort_by(sort_fields) {\r\n    return this.state.queryset ? this.state.queryset : [];\r\n  }\r\n \r\n  _sort_handler(field) {\r\n    return event => {\r\n      let index = _.findIndex(this.sort_fields, item =>\r\n        item.hasOwnProperty(field)\r\n      );\r\n      if (index >= 0) {\r\n        if (this.sort_fields[index][field] == \"asc\") {\r\n          this.sort_fields[index][field] = \"desc\";\r\n        } else {\r\n          this.sort_fields = _.filter(\r\n            this.sort_fields,\r\n            item => !item.hasOwnProperty(field)\r\n          );\r\n        }\r\n      } else {\r\n        let temp = {};\r\n        temp[field] = \"asc\";\r\n        this.sort_fields.push(temp);\r\n      }\r\n \r\n      this.sort_by(this.sort_fields);\r\n      this.forceUpdate();\r\n    };\r\n  }\r\n\r\n  get_form(object = null) {\r\n\r\n    // TODO:\r\n    // read params tenantId, module, master\r\n    // load schema using API for tenantId, module and master\r\n    // use that schema for editing\r\n    axios.get(\"/schema/module/masterName\",{\r\n      headers: {\r\n        'Accept': 'application/json',\r\n        'Content-Type': 'application/json',\r\n      }\r\n    \r\n    }).then(response => {\r\n    \r\n      console.log(typeof(response.data));\r\n      console.log(response.data);\r\n      this.schema=response.data;\r\n      \r\n    });\r\n  \r\n    if (!object) {\r\n      return <Form schema={this.schema} onSubmit={this.form_submit.bind(this)} />;\r\n    } else {\r\n      console.log(\"return form with data\", object);\r\n      return <Form schema={this.schema} formData={object} onSubmit={this.form_submit.bind(this)} />;\r\n    }\r\n  }\r\n  \r\n\r\n\r\n}"]},"metadata":{},"sourceType":"module"}